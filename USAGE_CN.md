# Mindsensor 使用指南

## 快速开始

### 1. 启动项目

```bash
# 进入项目目录
cd solana-mindsensor

# 安装依赖（如果还没安装）
pnpm install

# 启动开发服务器
pnpm run dev
```

浏览器会自动打开 `http://localhost:5173`

### 2. 准备工作

**浏览器要求**:
- ✅ Chrome 浏览器（推荐）
- ✅ Edge 浏览器
- ❌ Safari（不支持 Web Bluetooth）
- ❌ Firefox（不支持 Web Bluetooth）

**设备要求**:
- Mindsensor 蓝牙脑电波设备
- 设备名称必须以 `Mindsensor_` 开头
- 确保设备已充电并开机

## 详细使用步骤

### 第一步：进入应用

1. 打开浏览器访问 `http://localhost:5173`
2. 看到首页后，点击"进入监测页面"按钮
3. 进入 Monitor 监测页面

### 第二步：连接设备

有两种方式连接设备：

**方式一：自动扫描（推荐）**
1. 点击"扫描设备"按钮
2. 等待 10 秒，系统会自动搜索附近的 Mindsensor 设备
3. 设备列表会显示找到的设备
4. 点击您要连接的设备

**方式二：手动选择**
1. 点击"选择设备"按钮
2. 浏览器会弹出设备选择对话框
3. 选择您的 Mindsensor 设备
4. 点击"配对"

**连接过程**:
- 如果正在扫描，连接时会自动停止扫描
- 连接成功后，右上角状态指示器会变为绿色"已连接"
- 设备列表会自动隐藏

### 第三步：检查状态

连接成功后，页面会显示四个实时数据卡片：

1. **专注度**: 0-100 的数值，越高表示越专注
2. **放松度**: 0-100 的数值，越高表示越放松
3. **佩戴状态**: 
   - ✅ 正常：可以开始记录
   - ❌ 不正常：需要调整设备位置
4. **数据点数**: 已记录的数据点数量

**重要**: 只有当佩戴状态为"正常"时，"开始记录"按钮才可用。

### 第四步：开始记录

1. 确保佩戴状态为"正常"
2. 点击"开始记录"按钮
3. 系统会自动清空之前的数据
4. 按钮变为"结束记录"，右侧显示红色"正在记录..."
5. 实时图表开始绘制专注度和放松度曲线

**记录期间**:
- 实时图表每秒更新一次
- 数据点数会持续增加
- 可以随时查看当前的专注度和放松度

### 第五步：结束记录

1. 点击"结束记录"按钮
2. 自动跳转到结果页面
3. 查看完整的训练数据分析

### 第六步：查看结果

结果页面显示以下内容：

**统计卡片**:
- 训练时长：总共记录的时间
- 平均专注度：所有数据点的平均值
- 平均放松度：所有数据点的平均值
- 数据点数：总共记录的数据点

**详细图表**:
- 完整的时间轴曲线
- 专注度和放松度双曲线
- 鼠标悬停可查看具体时间点的数值

**时间信息**:
- 开始时间
- 结束时间

**操作按钮**:
- "返回监测"：返回继续记录
- "返回首页"：回到应用首页

## 蓝牙状态指示器

右上角的蓝牙状态指示器显示当前连接状态：

**状态颜色**:
- 🔴 红色：可能掉线（超过 3 秒未收到数据）
- 🟢 绿色：已连接
- 🟡 黄色：连接中或扫描中
- ⚪ 灰色：未连接

**点击查看详情**:
1. 点击右上角状态指示器
2. 弹窗显示详细信息：
   - 设备名称
   - 设备 ID
   - 上次数据时间（例如："3 秒前"）
   - 佩戴状态
   - 当前专注度
   - 当前放松度

**功能按钮**:
- "连接其他"：断开当前设备，扫描并连接新设备
- "断开连接"：断开当前设备
- "关闭"：关闭弹窗

## 其他功能

### 清空数据

如果想重新开始记录，而不想结束当前会话：

1. 点击"清空数据"按钮
2. 确认清空
3. 所有数据被清空，可以重新开始记录

**注意**: 此操作不可恢复！

### 掉线检测

系统会自动检测连接状态：

- 每秒检查一次
- 如果超过 3 秒未收到数据，状态变为"可能掉线"
- 右上角指示器变为红色
- 建议检查设备连接

### 佩戴状态监测

系统会实时监测设备佩戴状态：

- **sq = 0**: 佩戴正常
- **sq ≠ 0**: 佩戴不正常

佩戴不正常时：
- 数据可能不准确
- 无法开始记录
- 显示黄色警告提示

## 常见问题

### Q: 为什么扫描不到设备？

A: 请检查：
1. 设备是否开机
2. 设备是否在附近（< 10米）
3. 设备名称是否以 `Mindsensor_` 开头
4. 是否使用 Chrome/Edge 浏览器
5. 浏览器是否已授予蓝牙权限

### Q: 为什么无法连接设备？

A: 可能原因：
1. 设备已被其他程序连接
2. 蓝牙权限未授予
3. 设备电量过低
4. 尝试刷新页面重试

### Q: 连接后为什么没有数据？

A: 请检查：
1. 佩戴状态是否为"正常"
2. 设备是否正确佩戴在头上
3. 右上角状态是否为"已连接"（绿色）
4. 是否点击了"开始记录"

### Q: 数据突然停止更新？

A: 可能是掉线了：
1. 检查右上角状态指示器
2. 如果显示"可能掉线"，尝试重新连接
3. 检查设备电量
4. 确保设备与电脑距离不要太远

### Q: 刷新页面后数据丢失？

A: 目前版本的数据仅存储在内存中：
- 刷新页面会清空所有数据
- 建议在查看结果前不要刷新页面
- 未来版本会添加本地存储功能

### Q: 如何更换设备？

A: 两种方式：
1. 点击右上角状态指示器 → "连接其他"
2. 点击右上角状态指示器 → "断开连接" → 重新扫描

## 技术说明

### 数据采集频率

- 约每秒 1 次（取决于设备和信号质量）
- 数据包分为两段：
  - 第一段：sq、focus、relax、delta、theta、lowAlpha、highAlpha
  - 第二段：lowBeta、highBeta、lowGamma、highGamma

### 数据存储

- 当前仅内存存储
- 刷新页面会丢失数据
- 不上传到服务器
- 未来版本会支持导出功能

### 浏览器兼容性

| 浏览器 | 支持 | 说明 |
|--------|------|------|
| Chrome (桌面) | ✅ | 推荐使用 |
| Edge (桌面) | ✅ | 完全支持 |
| Safari | ❌ | 不支持 Web Bluetooth |
| Firefox | ❌ | 不支持 Web Bluetooth |
| Chrome (移动) | ⚠️ | 需要 HTTPS |

## 开发相关

### 构建生产版本

```bash
pnpm run build
```

构建产物在 `dist` 目录。

### 部署注意事项

生产环境必须使用 HTTPS：
- Web Bluetooth API 仅支持 localhost 或 HTTPS
- 部署到服务器时确保配置了 SSL 证书

### 预览生产版本

```bash
pnpm run preview
```

## 联系与支持

如有问题或建议，请联系开发团队。

